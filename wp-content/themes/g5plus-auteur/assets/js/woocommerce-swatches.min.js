var G5_Woocommerce_Swatches=window.G5_Woocommerce_Swatches||{};!function(f){"use strict";window.G5_Woocommerce_Swatches=G5_Woocommerce_Swatches;var o=woocommerce_swatches_var.price_selector,n=woocommerce_swatches_var.localization;G5_Woocommerce_Swatches={init:function(){this.initSwatches(),this.events()},events:function(){f("body").on("gf_woocommerce_ajax_success gf_quick_view_success",function(){setTimeout(function(){G5_Woocommerce_Swatches.initSwatches()},500),setTimeout(function(){G5_Woocommerce_Swatches.initSwatches()},1e3)})},initSwatches:function(){f(".gf-swatches-wrap").each(function(){var a=f(this),t=a.find(".swatches-item:not(.swatches-disabled)"),s=a.find(".reset_variations"),c=a.closest(".product-item-wrap"),i=f.parseJSON(a.attr("data-product_variations"));a.find(".swatches-inner").length||a.addClass("swatches-empty"),t.length&&t.unbind("click").on("click",function(t){var e=f(this);if(e.hasClass("swatches-disabled"))return!1;c.find(".swatches-item").removeClass("swatches-disabled swatches-enabled"),e.parent().find(".swatches-item.swatches-selected").removeClass("swatches-selected"),e.hasClass("swatches-selected")?(e.parent().removeClass("swatches-activated"),c.removeClass("gf-product-swatched"),c.find(".swatches-selected").length||s.trigger("click")):(e.parent().addClass("swatches-activated"),e.addClass("swatches-selected"),c.addClass("gf-product-swatched"),s.addClass("show").show()),G5_Woocommerce_Swatches.execVariable(a,i,s,e),t.preventDefault()}),s.unbind("click").on("click",function(){c.removeClass("gf-product-swatched"),a.removeAttr("data-variation_id"),a.find(".swatches-inner").removeClass("swatches-activated"),a.find(".swatches-item").removeClass("swatches-enabled swatches-disabled swatches-selected"),f("body").trigger("gf_reset_add_to_cart_button_text"),c.find(".add_to_cart_button").removeClass("ajax_add_to_cart swatches-text-changed added loading").text(n.select_options_text),c.find(".add_to_cart_button").closest(".add_to_cart_tooltip").length&&(c.find(".add_to_cart_button").closest(".add_to_cart_tooltip").data("original-title",n.select_options_text).tooltip("_fixTitle"),c.find(".add_to_cart_button").closest(".add_to_cart_tooltip").attr("data-original-title",n.select_options_text).tooltip("_fixTitle"));var t=c.find(o).not(".price-cloned"),e=c.find(".price-cloned");return e.length&&(t.html(e.html()),e.remove()),G5_Woocommerce_Swatches.variationsImageUpdate(!1,c),f(this).removeClass("show").hide(),!1})}),f(".gf-swatches-single-wrap").each(function(){var c=f("form.gf-swatches.variations_form"),t=c.find(".swatches-item"),e=c.find(".swatches-item:not(.swatches-disabled)");t.each(function(){var t=f(this),e=t.attr("data-term"),t=t.parent().attr("data-attribute"),t=c.find("select#"+t).val();""!=t&&e==t&&f(this).addClass("swatches-selected")}),e.unbind("click").on("click",function(t){var e=f(this),a=e.attr("data-term"),s=e.parent().attr("data-attribute"),s=c.find("select#"+s);if(e.hasClass("swatches-disabled"))return!1;s.val(a).trigger("change"),e.parent().find(".swatches-selected").removeClass("swatches-selected"),e.addClass("swatches-selected"),t.preventDefault()}),c.on("woocommerce_update_variation_values",function(){c.find("select").each(function(){var t=f(this),e=t.parent().find(".swatches-inner");e.find(".swatches-item").removeClass("swatches-enabled").addClass("swatches-disabled"),t.find("option.enabled").each(function(){var t=f(this).val();e.find('.swatches-item[data-term="'+t+'"]').removeClass("swatches-disabled").addClass("swatches-enabled")})})}),c.on("reset_data",function(){f(this).parent().find(".swatches-selected").removeClass("swatches-selected")})})},execVariable:function(t,e,a,s){var c=G5_Woocommerce_Swatches.getChosenAttributes(t),i=c.data;G5_Woocommerce_Swatches.updateAttributes(t,e),c.count===c.chosenCount&&((i=G5_Woocommerce_Swatches.findMatchingVariations(e,i).shift())?G5_Woocommerce_Swatches.foundVariation(t,i):a.trigger("click"))},getChosenAttributes:function(t){var a={},s=0,c=0;return t.find(".swatches-inner").each(function(){var t="attribute_"+f(this).attr("data-attribute"),e=f(this).find(".swatches-item.swatches-selected").attr("data-term")||"";0<e.length&&c++,s++,a[t]=e}),{count:s,chosenCount:c,data:a}},updateAttributes:function(t,_){var m,w=G5_Woocommerce_Swatches.getChosenAttributes(t).data;t.find(".swatches-inner").each(function(t,e){var a=f(e),s="attribute_"+a.attr("data-attribute"),c=a.find(".swatches-item.swatches-selected").attr("data-term"),i=!0,e=f.extend(!0,{},w);e[s]="",f(this).find(".swatches-item").removeClass("swatches-enabled");var o,n=G5_Woocommerce_Swatches.findMatchingVariations(_,e);for(o in n)if(void 0!==n[o]){var r,d,h,l=n[o].attributes;for(r in l)l.hasOwnProperty(r)&&(d=l[r],h="",r===s&&(n[o].variation_is_active&&(h="enabled"),(d?a.find('.swatches-item[data-term="'+d+'"]'):a.find(".swatches-item")).addClass("swatches-"+h)))}m=a.find(".swatches-item.swatches-enabled").length,!c||0!==m&&0!==a.find('.swatches-item.swatches-enabled[data-term="'+G5_Woocommerce_Swatches.addSlashes(c)+'"]').length||(i=!1),a.find(".swatches-item:not(.swatches-enabled)").addClass("swatches-disabled"),c&&i||a.find(".swatches-item.swatches-selected").removeClass("swatches-selected")})},findMatchingVariations:function(t,e){for(var a=[],s=0;s<t.length;s++){var c=t[s];G5_Woocommerce_Swatches.isMatch(c.attributes,e)&&a.push(c)}return a},isMatch:function(t,e){var a,s,c,i=!0;for(a in t)t.hasOwnProperty(a)&&(s=t[a],c=e[a],void 0!==s&&void 0!==c&&0!==s.length&&0!==c.length&&s!==c&&(i=!1));return i},addSlashes:function(t){return t=(t=t.replace(/'/g,"\\'")).replace(/"/g,'\\"')},foundVariation:function(t,e){var a=t.closest(".product"),s=a.find(o).not(".price-cloned"),c=s.clone().addClass("price-cloned").css("display","none");e.price_html?(a.find(".price-cloned").length||a.append(c),s.replaceWith(e.price_html)):a.find(".price-cloned").length&&(s.replaceWith(c.html()),c.remove()),t.attr("data-variation_id",e.variation_id),G5_Woocommerce_Swatches.variationsImageUpdate(e,a),G5_Woocommerce_Swatches.changeAddToCartBtnText(e,a)},variationsImageUpdate:function(t,e){var a=e.find(".wp-post-image");e.find(".product-thumb-secondary").length&&(a=e.find(".product-thumb-secondary").find(".wp-post-image")),t&&t.image.src?(G5_Woocommerce_Swatches.setVariationAttr(a,"src",t.image.thumb_src),G5_Woocommerce_Swatches.setVariationAttr(a,"srcset",t.image.thumb_srcset)):(G5_Woocommerce_Swatches.resetVariationAttr(a,"src"),G5_Woocommerce_Swatches.resetVariationAttr(a,"srcset"))},resetVariationAttr:function(t,e){void 0!==t.attr("data-o_"+e)&&t.attr(e,t.attr("data-o_"+e))},setVariationAttr:function(t,e,a){void 0===t.attr("data-o_"+e)&&t.attr("data-o_"+e,t.attr(e)?t.attr(e):""),!1===a?t.removeAttr(e):t.attr(e,a)},changeAddToCartBtnText:function(t,e){var a=e.find(".add_to_cart_button"),s=e.find(".added_to_cart"),e="";a.removeClass("added"),s.length&&s.remove(),console.log(a),a.data("product_id",t.variation_id),a.attr("data-product_id",t.variation_id),!0===t.is_in_stock?(e=n.add_to_cart_text,a.addClass("ajax_add_to_cart")):(e=n.read_more_text,a.removeClass("ajax_add_to_cart")),a.addClass("swatches-text-changed").text(e),a.closest(".add_to_cart_tooltip").length&&(a.closest(".add_to_cart_tooltip").data("original-title",e).tooltip("_fixTitle"),a.closest(".add_to_cart_tooltip").attr("data-original-title",e).tooltip("_fixTitle")),f("body").trigger("gf_change_add_to_cart_button_text")}},f(document).ready(function(){G5_Woocommerce_Swatches.init()})}(jQuery);